import{_ as E,a as R,r as m,o as V,m as B,t as h,C as O,v as k,x as a,F as H,D as Q,E as P,G as j,y as b,H as A,I as W,j as M,B as D,J as U,K as X,L as F,z as K}from"./Ckj89h4T.js";import{C as T}from"./iCYYr22m.js";const Y={key:0,class:"dashboard-container"},Z={class:"grid"},aa={class:"card-header"},ta={class:"count"},ea={key:0,class:"modal"},sa={class:"modal-content"},oa={class:"form-group"},na={__name:"dashboard",setup(I){const{$cookies:y}=R(),c=m({}),d=m(null),u=m(null),f=m(null),e=[{title:"Total Kontak",key:"total_contact",icon:"fas fa-address-book"},{title:"Total Foto Galeri",key:"total_gallery_image",icon:"fas fa-images"},{title:"Total Portfolio",key:"total_portfolio_image",icon:"fas fa-briefcase"}],v=m(!1),S=async()=>{try{const o=await fetch("/api/dashboard");c.value=await o.json()}catch(o){throw o}};V(async()=>{await S();const t=B().public.token,_=await(await fetch("/api/utils/sk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t})})).json();d.value=T.AES.decrypt(y.get("auth"),_).toString(T.enc.Utf8)});const $=()=>{v.value=!0},x=()=>{v.value=!1},p=async()=>{try{const t=B().public.token,_=await(await fetch("/api/utils/sk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t})})).json(),w=T.AES.encrypt(JSON.stringify({username:d.value,oldPassword:u.value,password:f.value,token:t}),_).toString(),i=await(await fetch("/api/user/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)})).json();i.message=="ok"?(alert("Update successfully!"),v.value=!1):(alert(i.message),v.value=!1)}catch(o){throw o}};return(o,t)=>c.value?(k(),h("div",Y,[t[10]||(t[10]=a("div",{class:"header"},[a("h1",{class:"fade-in"},"Selamat datang kembali, Admin!")],-1)),a("div",Z,[(k(),h(H,null,Q(e,r=>a("div",{key:r.title,class:"card fade-in"},[a("div",aa,[a("p",null,b(r.title),1),a("i",{class:A([r.icon,"icon"])},null,2)]),t[3]||(t[3]=a("p",{class:"subtext"},"Per hari ini",-1)),a("h1",ta,b(c.value[r.key]),1)])),64)),a("div",{class:"card fade-in password-card"},[t[4]||(t[4]=a("div",{class:"card-header"},[a("p",null,"Ubah Password"),a("i",{class:"fas fa-lock icon"})],-1)),t[5]||(t[5]=a("p",{class:"subtext"},"Keamanan akun Anda sangat penting",-1)),a("button",{class:"btn-change-password",onClick:$},"Ubah Sekarang")])]),v.value?(k(),h("div",ea,[a("div",sa,[a("span",{class:"close-btn",onClick:x},"×"),t[9]||(t[9]=a("h3",null,"Ubah data admin",-1)),a("div",oa,[t[6]||(t[6]=a("label",{for:"username",class:"form-label"},"Username",-1)),P(a("input",{type:"text",name:"username",id:"username","onUpdate:modelValue":t[0]||(t[0]=r=>d.value=r),placeholder:"username",class:"form-control"},null,512),[[j,d.value]]),t[7]||(t[7]=a("label",{for:"oldPassword",class:"form-label"},"Old password",-1)),P(a("input",{type:"password",name:"oldPassword","onUpdate:modelValue":t[1]||(t[1]=r=>u.value=r),placeholder:"old password",class:"form-control",maxlength:"8"},null,512),[[j,u.value]]),t[8]||(t[8]=a("label",{for:"password",class:"form-label"},"Password",-1)),P(a("input",{type:"password",name:"password","onUpdate:modelValue":t[2]||(t[2]=r=>f.value=r),placeholder:"password",class:"form-control",maxlength:"8"},null,512),[[j,f.value]]),a("button",{onClick:p,class:"btn btn-primary"},"Simpan")])])])):O("",!0)])):O("",!0)}},la=E(na,[["__scopeId","data-v-ca7dfa02"]]),ia={class:"table-container"},ra={class:"custom-table"},ua=["onDblclick"],da=["src"],ca=["onClick"],pa=["onClick"],ma={class:"pagination"},fa=["disabled"],va=["disabled"],ga={class:"form-group"},ba={class:"form-group"},ya={key:1,class:"text-center"},ha={type:"submit",class:"save-btn"},L=3,ka={__name:"portfolio",setup(I){const y=m([]),c=m(!1),d=m(!1),u=m({portfolio_id:null,name:"",image:""}),f=m(""),e=m(1),v=m("name"),S=m(!0),$=async()=>{try{const l=await fetch("/api/portfolio/");y.value=await l.json()}catch(l){throw l}};V($),W(f,()=>{e.value=1});const x=M(()=>y.value.filter(l=>l.name.toLowerCase().includes(f.value.toLowerCase()))),p=M(()=>{const l=(e.value-1)*L;return x.value.slice(l,l+L)}),o=M(()=>Math.max(1,Math.ceil(x.value.length/L))),t=(l={portfolio_id:null,name:"",image:""})=>{u.value={...l},d.value=!!l.portfolio_id,c.value=!0},r=()=>{c.value=!1},_=async()=>{const l=new FormData;l.append("name",u.value.name),u.value.image instanceof File&&l.append("image",u.value.image);try{let s;d.value?(l.append("action","edit"),l.append("portfolio_id",u.value.portfolio_id),s=await fetch("/api/portfolio",{method:"POST",body:l})):(l.append("action","add"),s=await fetch("/api/portfolio",{method:"POST",body:l})),(await s.json()).message==="ok"?(alert("Penyimpanan berhasil!"),$(),r()):(alert("Penyimpanan gagal!"),r())}catch{alert("Penyimpanan gagal!"),r()}},w=async l=>{if(confirm("Hapus perusahaan ini?")){const s=new FormData;s.append("action","delete"),s.append("portfolio_id",l);const N=await(await fetch("/api/portfolio",{method:"POST",body:s})).json();N.message==="ok"?(alert("Berhasil dihapus!"),$(),e.value=1):(console.log(N),alert("Gagal dihapus!"),$(),e.value=1)}},G=l=>{l>=1&&l<=o.value&&(e.value=l)},i=l=>{v.value===l?S.value=!S.value:(v.value=l,S.value=!0),y.value=[...y.value].sort((s,g)=>(s[l]>g[l]?1:-1)*(S.value?1:-1))},n=({target:{files:l}})=>{l[0]&&(u.value.image=l[0])},C=l=>l?`/api/image/${l}`:"/default-image.jpg";return(l,s)=>(k(),h("div",ia,[s[15]||(s[15]=a("h2",{class:"title"},"Daftar Perusahaan",-1)),P(a("input",{"onUpdate:modelValue":s[0]||(s[0]=g=>f.value=g),type:"text",placeholder:"Cari perusahaan...",class:"search-input"},null,512),[[j,f.value]]),a("button",{class:"add-btn",onClick:s[1]||(s[1]=g=>t())},s[8]||(s[8]=[a("i",{class:"fa fa-plus"},null,-1),D(" Tambah Perusahaan ")])),a("table",ra,[a("thead",null,[a("tr",null,[a("th",{onClick:s[2]||(s[2]=g=>i("index"))},"No"),s[9]||(s[9]=a("th",null,"Gambar",-1)),a("th",{onClick:s[3]||(s[3]=g=>i("name"))},"Nama Perusahaan"),s[10]||(s[10]=a("th",null,"Aksi",-1))])]),a("tbody",null,[(k(!0),h(H,null,Q(p.value,(g,N)=>(k(),h("tr",{key:g.id||N,onDblclick:q=>t(g)},[a("td",null,b(N+1+(e.value-1)*L),1),a("td",null,[a("img",{src:C(g.image),alt:"Gambar",class:"logo-img"},null,8,da)]),a("td",null,b(g.name),1),a("td",null,[a("button",{onClick:U(q=>t(g),["stop"]),class:"edit-btn"},s[11]||(s[11]=[a("i",{class:"fa fa-pencil"},null,-1)]),8,ca),a("button",{onClick:U(q=>w(g.portfolio_id),["stop"]),class:"delete-btn"},s[12]||(s[12]=[a("i",{class:"fa fa-trash"},null,-1)]),8,pa)])],40,ua))),128))])]),a("div",ma,[a("button",{onClick:s[4]||(s[4]=g=>G(e.value-1)),disabled:e.value===1},"Previous",8,fa),a("span",null,"Page "+b(e.value)+" of "+b(o.value),1),a("button",{onClick:s[5]||(s[5]=g=>G(e.value+1)),disabled:e.value===o.value},"Next",8,va)]),c.value?(k(),h("div",{key:0,class:"modal",onClick:r},[a("div",{class:"modal-content",onClick:s[7]||(s[7]=U(()=>{},["stop"]))},[a("span",{class:"close-btn",onClick:r},"×"),a("h3",null,b(d.value?"Edit Perusahaan":"Tambah Perusahaan"),1),a("form",{onSubmit:U(_,["prevent"])},[a("div",ga,[s[13]||(s[13]=a("label",{class:"form-label",for:"name"},"Nama Perusahaan:",-1)),P(a("input",{class:"form-control","onUpdate:modelValue":s[6]||(s[6]=g=>u.value.name=g),type:"text",id:"name",required:""},null,512),[[j,u.value.name]])]),a("div",ba,[s[14]||(s[14]=a("label",{class:"form-label",for:"image"},"Gambar:",-1)),u.value.portfolio_id==null?(k(),h("input",{key:0,class:"form form-control",type:"file",onChange:n,accept:"image/*"},null,32)):O("",!0),u.value.portfolio_id!=null?(k(),h("div",ya,[a("input",{class:"form form-control",type:"file",onChange:n,accept:"image/*"},null,32)])):O("",!0)]),a("button",ha,b(d.value?"Simpan":"Tambah"),1)],32)])])):O("",!0)]))}},Ca=E(ka,[["__scopeId","data-v-3f9257d5"]]),wa={class:"table-container"},$a={class:"custom-table"},Pa=["src"],_a=["onClick"],Sa=["onClick"],Ta={class:"pagination"},Ma=["disabled"],xa=["disabled"],Ga={class:"form-group"},Da={class:"form-group"},ja={type:"submit",class:"save-btn"},J=3,Ua={__name:"gallery",setup(I){const y=m([]),c=m(!1),d=m(!1),u=m({gallery_id:null,image:"",category:""}),f=m(""),e=m(1),v=async()=>{try{const i=await fetch("/api/gallery/");y.value=await i.json()}catch(i){throw i}},S=i=>i?`/api/image/${i}`:"/default-image.jpg";W(f,()=>{e.value=1}),V(v);const $=M(()=>y.value.filter(i=>i.category.toLowerCase().includes(f.value.toLowerCase()))),x=M(()=>{const i=(e.value-1)*J;return $.value.slice(i,i+J)}),p=M(()=>Math.max(1,Math.ceil($.value.length/J))),o=i=>{i>=1&&i<=p.value&&(e.value=i)},t=(i={gallery_id:null,image:"",category:""})=>{u.value={...i},d.value=!!i.gallery_id,c.value=!0},r=()=>{c.value=!1},_=({target:{files:i}})=>{i[0]&&(u.value.image=i[0])},w=async()=>{const i=new FormData;i.append("category",u.value.category),u.value.image instanceof File&&i.append("image",u.value.image);try{let n;d.value?(i.append("action","edit"),i.append("gallery_id",u.value.gallery_id),n=await fetch("/api/gallery",{method:"POST",body:i})):(i.append("action","add"),n=await fetch("/api/gallery",{method:"POST",body:i})),(await n.json()).message==="ok"?(alert("Penyimpanan berhasil!"),v(),r()):(alert("Penyimpanan gagal!"),r())}catch{alert("Penyimpanan gagal!"),r()}},G=async i=>{if(confirm("Hapus perusahaan ini?")){const n=new FormData;n.append("action","delete"),n.append("gallery_id",i),(await(await fetch("/api/gallery",{method:"POST",body:n})).json()).message==="ok"?(alert("Berhasil dihapus!"),v(),e.value=1):(alert("Gagal dihapus!"),v(),e.value=1)}};return(i,n)=>(k(),h("div",wa,[n[13]||(n[13]=a("h2",{class:"title"},"Daftar Gambar",-1)),P(a("input",{"onUpdate:modelValue":n[0]||(n[0]=C=>f.value=C),type:"text",placeholder:"Tulis kategori...",class:"search-input"},null,512),[[j,f.value]]),a("button",{class:"add-btn",onClick:n[1]||(n[1]=C=>t())},n[6]||(n[6]=[a("i",{class:"fa fa-plus"},null,-1),D(" Tambah Gambar ")])),a("table",$a,[n[9]||(n[9]=a("thead",null,[a("tr",null,[a("th",null,"No"),a("th",null,"Gambar"),a("th",null,"Category"),a("th",null,"Aksi")])],-1)),a("tbody",null,[(k(!0),h(H,null,Q(x.value,(C,l)=>(k(),h("tr",{key:C.gallery_id},[a("td",null,b(l+1+(e.value-1)*J),1),a("td",null,[a("img",{src:S(C.image),alt:"Gambar",class:"logo-img"},null,8,Pa)]),a("td",null,b(C.category),1),a("td",null,[a("button",{onClick:s=>t(C),class:"edit-btn"},n[7]||(n[7]=[a("i",{class:"fa fa-pencil"},null,-1)]),8,_a),a("button",{onClick:s=>G(C.gallery_id),class:"delete-btn"},n[8]||(n[8]=[a("i",{class:"fa fa-trash"},null,-1)]),8,Sa)])]))),128))])]),a("div",Ta,[a("button",{onClick:n[2]||(n[2]=C=>o(e.value-1)),disabled:e.value===1},"Previous",8,Ma),a("span",null,"Page "+b(e.value)+" of "+b(p.value),1),a("button",{onClick:n[3]||(n[3]=C=>o(e.value+1)),disabled:e.value===p.value},"Next",8,xa)]),c.value?(k(),h("div",{key:0,class:"modal",onClick:r},[a("div",{class:"modal-content",onClick:n[5]||(n[5]=U(()=>{},["stop"]))},[a("span",{class:"close-btn",onClick:r},"×"),a("h3",null,b(d.value?"Edit Gambar":"Tambah Gambar"),1),a("form",{onSubmit:U(w,["prevent"])},[a("div",Ga,[n[11]||(n[11]=a("label",{for:"category"},"Category:",-1)),P(a("select",{name:"category",id:"category","onUpdate:modelValue":n[4]||(n[4]=C=>u.value.category=C),class:"form-select"},n[10]||(n[10]=[a("option",{value:"general trading"},"general trading",-1),a("option",{value:"konstruksi"},"konstruksi",-1),a("option",{value:"transporter"},"transporter",-1)]),512),[[X,u.value.category]])]),a("div",Da,[n[12]||(n[12]=a("label",{for:"image"},"Gambar:",-1)),a("input",{class:"form-control",type:"file",onChange:_,accept:"image/*"},null,32)]),a("button",ja,b(d.value?"Simpan":"Tambah"),1)],32)])])):O("",!0)]))}},Oa=E(Ua,[["__scopeId","data-v-6256d560"]]),Na={class:"contact-list-container"},Aa={class:"search-wrapper"},Ea={class:"table-container"},Va={class:"contact-table"},Ia=["onClick"],Fa={class:"pagination-controls"},Ka=["disabled"],La={class:"page-indicator"},Ja=["disabled"],z=3,Ba={__name:"contact",setup(I){const y=m([]),c=m(""),d=m(1),u=M(()=>Math.ceil(f.value.length/z)),f=M(()=>y.value.filter(p=>p.name.toLowerCase().includes(c.value.toLowerCase()))),e=M(()=>{const p=(d.value-1)*z,o=p+z;return f.value.slice(p,o)});V(async()=>{await v()});async function v(){const p="s@runggoniT1ungsir4h";try{const t=B().public.token,r=await fetch("/api/contact/getContact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t})});if(r.ok){const _=await r.json();y.value=_.map(w=>({id:w.contact_id,name:T.AES.decrypt(w.name,p).toString(T.enc.Utf8),email:T.AES.decrypt(w.email,p).toString(T.enc.Utf8),phone:T.AES.decrypt(w.phone,p).toString(T.enc.Utf8)}))}else alert("Gagal memuat kontak!")}catch(o){throw o}}async function S(p){try{const r=B().public.token;var o=await(await fetch("/api/contact/deleteContact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:r,id:p})})).json();if(o.message=="ok"){const w=y.value.findIndex(G=>G.id===p);w!==-1&&(y.value.splice(w,1),alert("Data berhasil terhapus!"))}else alert("Data gagal terhapus!")}catch{alert("Data gagal terhapus!")}}function $(p){p>=1&&p<=u.value&&(d.value=p)}const x=async()=>{await v()};return(p,o)=>(k(),h("div",Na,[o[9]||(o[9]=a("h1",{class:"header"},"Daftar Kontak",-1)),a("div",Aa,[P(a("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>c.value=t),type:"text",placeholder:"Cari berdasarkan nama",class:"search-input"},null,512),[[j,c.value]]),o[3]||(o[3]=a("i",{class:"fas fa-search search-icon"},null,-1))]),a("div",Ea,[a("table",Va,[a("thead",null,[a("tr",null,[a("th",null,[a("i",{class:"fa fa-refresh pointer",onClick:x})]),o[4]||(o[4]=a("th",null,"Nama",-1)),o[5]||(o[5]=a("th",null,"Telepon",-1)),o[6]||(o[6]=a("th",null,"Email",-1)),o[7]||(o[7]=a("th",null,"Aksi",-1))])]),a("tbody",null,[(k(!0),h(H,null,Q(e.value,(t,r)=>(k(),h("tr",{key:t.id},[o[8]||(o[8]=a("td",null,null,-1)),a("td",null,b(t.name),1),a("td",null,b(t.phone),1),a("td",null,b(t.email),1),a("td",null,[a("button",{onClick:_=>S(t.id),class:"btn-delete"},"Hapus",8,Ia)])]))),128))])])]),a("div",Fa,[a("button",{onClick:o[1]||(o[1]=t=>$(d.value-1)),disabled:d.value===1,class:"pagination-btn"},"Sebelumnya",8,Ka),a("span",La,b(d.value)+" / "+b(u.value),1),a("button",{onClick:o[2]||(o[2]=t=>$(d.value+1)),disabled:d.value===u.value,class:"pagination-btn"},"Berikutnya",8,Ja)])]))}},Ha=E(Ba,[["__scopeId","data-v-e1ed501f"]]),Qa={class:"admin-container"},za={class:"sidebar"},qa={class:"main-content"},Ra={__name:"dashboard",setup(I){const{$cookies:y}=R();V(()=>{try{y.get("auth")||(window.location.href="/admin")}catch(f){throw f}});const c=m("dashboard"),d=f=>{c.value=f},u=()=>{y.remove("auth",{path:"/admin"}),setTimeout(()=>{window.location.href="/admin"},300)};return(f,e)=>(k(),h("div",Qa,[a("aside",za,[a("ul",null,[a("li",{onClick:e[0]||(e[0]=v=>d("dashboard")),class:A({active:c.value==="dashboard"})},e[4]||(e[4]=[a("i",{class:"fas fa-tachometer-alt"},null,-1),D(" Dasbor ")]),2),a("li",{onClick:e[1]||(e[1]=v=>d("portfolio")),class:A({active:c.value==="portfolio"})},e[5]||(e[5]=[a("i",{class:"fas fa-briefcase"},null,-1),D(" Portofolio ")]),2),a("li",{onClick:e[2]||(e[2]=v=>d("gallery")),class:A({active:c.value==="gallery"})},e[6]||(e[6]=[a("i",{class:"fas fa-images"},null,-1),D(" Galeri ")]),2),a("li",{onClick:e[3]||(e[3]=v=>d("contact")),class:A({active:c.value==="contact"})},e[7]||(e[7]=[a("i",{class:"fas fa-address-book"},null,-1),D(" Kontak ")]),2),a("li",null,[a("button",{class:"btn form-control p-2 btn-danger",onClick:u},e[8]||(e[8]=[a("i",{class:"fas fa-sign-out-alt"},null,-1),D(" Logout ")]))])])]),a("main",qa,[P(K(la,null,null,512),[[F,c.value==="dashboard"]]),P(K(Ca,null,null,512),[[F,c.value==="portfolio"]]),P(K(Oa,null,null,512),[[F,c.value==="gallery"]]),P(K(Ha,null,null,512),[[F,c.value==="contact"]])])]))}},Ya=E(Ra,[["__scopeId","data-v-eefca7cb"]]);export{Ya as default};
